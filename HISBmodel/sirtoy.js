G_5={"directed": false, "graph": {}, "nodes": [{"name": 0}, {"name": 1}, {"name": 2}, {"name": 3}, {"name": 4}, {"name": 5}, {"name": 6}, {"name": 7}, {"name": 8}, {"name": 9}, {"name": 10}, {"name": 11}, {"name": 12}, {"name": 13}, {"name": 14}, {"name": 15}, {"name": 16}, {"name": 17}, {"name": 18}, {"name": 19}, {"name": 20}, {"name": 21}, {"name": 22}, {"name": 23}, {"name": 24}, {"name": 25}, {"name": 26}, {"name": 27}, {"name": 28}, {"name": 29}, {"name": 30}, {"name": 31}, {"name": 32}, {"name": 33}, {"name": 34}, {"name": 35}, {"name": 36}, {"name": 37}, {"name": 38}, {"name": 39}, {"name": 40}, {"name": 41}, {"name": 42}, {"name": 43}, {"name": 44}, {"name": 45}, {"name": 46}, {"name": 47}, {"name": 48}, {"name": 49}, {"name": 50}, {"name": 51}, {"name": 52}, {"name": 53}, {"name": 54}, {"name": 55}, {"name": 56}, {"name": 57}, {"name": 58}, {"name": 59}, {"name": 60}, {"name": 61}, {"name": 62}, {"name": 63}, {"name": 64}, {"name": 65}, {"name": 66}, {"name": 67}, {"name": 68}, {"name": 69}, {"name": 70}, {"name": 71}, {"name": 72}, {"name": 73}, {"name": 74}, {"name": 75}, {"name": 76}, {"name": 77}, {"name": 78}, {"name": 79}, {"name": 80}, {"name": 81}, {"name": 82}, {"name": 83}, {"name": 84}, {"name": 85}, {"name": 86}, {"name": 87}, {"name": 88}, {"name": 89}, {"name": 90}, {"name": 91}, {"name": 92}, {"name": 93}, {"name": 94}, {"name": 95}, {"name": 96}, {"name": 97}, {"name": 98}, {"name": 99}, {"name": 100}, {"name": 101}, {"name": 102}, {"name": 103}, {"name": 104}, {"name": 105}, {"name": 106}, {"name": 107}, {"name": 108}, {"name": 109}, {"name": 110}, {"name": 111}, {"name": 112}, {"name": 113}, {"name": 114}, {"name": 115}, {"name": 116}, {"name": 117}, {"name": 118}, {"name": 119}, {"name": 120}, {"name": 121}, {"name": 122}, {"name": 123}, {"name": 124}, {"name": 125}, {"name": 126}, {"name": 127}, {"name": 128}, {"name": 129}, {"name": 130}, {"name": 131}, {"name": 132}, {"name": 133}, {"name": 134}, {"name": 135}, {"name": 136}, {"name": 137}, {"name": 138}, {"name": 139}, {"name": 140}, {"name": 141}, {"name": 142}, {"name": 143}, {"name": 144}, {"name": 145}, {"name": 146}, {"name": 147}, {"name": 148}, {"name": 149}, {"name": 150}, {"name": 151}, {"name": 152}, {"name": 153}, {"name": 154}, {"name": 155}, {"name": 156}, {"name": 157}, {"name": 158}, {"name": 159}, {"name": 160}, {"name": 161}, {"name": 162}, {"name": 163}, {"name": 164}, {"name": 165}, {"name": 166}, {"name": 167}, {"name": 168}, {"name": 169}, {"name": 170}, {"name": 171}, {"name": 172}, {"name": 173}, {"name": 174}, {"name": 175}, {"name": 176}, {"name": 177}, {"name": 178}, {"name": 179}, {"name": 180}, {"name": 181}, {"name": 182}, {"name": 183}, {"name": 184}, {"name": 185}, {"name": 186}, {"name": 187}, {"name": 188}, {"name": 189}, {"name": 190}, {"name": 191}, {"name": 192}, {"name": 193}, {"name": 194}, {"name": 195}, {"name": 196}, {"name": 197}, {"name": 198}, {"name": 199}, {"name": 200}, {"name": 201}, {"name": 202}, {"name": 203}, {"name": 204}, {"name": 205}, {"name": 206}, {"name": 207}, {"name": 208}, {"name": 209}, {"name": 210}, {"name": 211}, {"name": 212}, {"name": 213}, {"name": 214}, {"name": 215}, {"name": 216}, {"name": 217}, {"name": 218}, {"name": 219}, {"name": 220}, {"name": 221}, {"name": 222}, {"name": 223}, {"name": 224}, {"name": 225}, {"name": 226}, {"name": 227}, {"name": 228}, {"name": 229}, {"name": 230}, {"name": 231}, {"name": 232}, {"name": 233}, {"name": 234}, {"name": 235}, {"name": 236}, {"name": 237}, {"name": 238}, {"name": 239}, {"name": 240}, {"name": 241}, {"name": 242}, {"name": 243}, {"name": 244}, {"name": 245}, {"name": 246}, {"name": 247}, {"name": 248}, {"name": 249}, {"name": 250}, {"name": 251}, {"name": 252}, {"name": 253}, {"name": 254}, {"name": 255}, {"name": 256}, {"name": 257}, {"name": 258}, {"name": 259}, {"name": 260}, {"name": 261}, {"name": 262}, {"name": 263}, {"name": 264}, {"name": 265}, {"name": 266}, {"name": 267}, {"name": 268}, {"name": 269}, {"name": 270}, {"name": 271}, {"name": 272}, {"name": 273}, {"name": 274}, {"name": 275}, {"name": 276}, {"name": 277}, {"name": 278}, {"name": 279}, {"name": 280}, {"name": 281}, {"name": 282}, {"name": 283}, {"name": 284}, {"name": 285}, {"name": 286}, {"name": 287}, {"name": 288}, {"name": 289}, {"name": 290}, {"name": 291}, {"name": 292}, {"name": 293}, {"name": 294}, {"name": 295}, {"name": 296}, {"name": 297}, {"name": 298}, {"name": 299}, {"name": 300}, {"name": 301}, {"name": 302}, {"name": 303}, {"name": 304}, {"name": 305}, {"name": 306}, {"name": 307}, {"name": 308}, {"name": 309}, {"name": 310}, {"name": 311}, {"name": 312}, {"name": 313}, {"name": 314}, {"name": 315}, {"name": 316}, {"name": 317}, {"name": 318}, {"name": 319}, {"name": 320}, {"name": 321}, {"name": 322}, {"name": 323}, {"name": 324}, {"name": 325}, {"name": 326}, {"name": 327}, {"name": 328}, {"name": 329}, {"name": 330}, {"name": 331}, {"name": 332}, {"name": 333}, {"name": 334}, {"name": 335}, {"name": 336}, {"name": 337}, {"name": 338}, {"name": 339}, {"name": 340}, {"name": 341}, {"name": 342}, {"name": 343}, {"name": 344}, {"name": 345}, {"name": 346}, {"name": 347}, {"name": 348}, {"name": 349}, {"name": 350}, {"name": 351}, {"name": 352}, {"name": 353}, {"name": 354}, {"name": 355}, {"name": 356}, {"name": 357}, {"name": 358}, {"name": 359}, {"name": 360}, {"name": 361}, {"name": 362}, {"name": 363}, {"name": 364}, {"name": 365}, {"name": 366}, {"name": 367}, {"name": 368}, {"name": 369}, {"name": 370}, {"name": 371}, {"name": 372}, {"name": 373}, {"name": 374}, {"name": 375}, {"name": 376}, {"name": 377}, {"name": 378}, {"name": 379}, {"name": 380}, {"name": 381}, {"name": 382}, {"name": 383}, {"name": 384}, {"name": 385}, {"name": 386}, {"name": 387}, {"name": 388}, {"name": 389}, {"name": 390}, {"name": 391}, {"name": 392}, {"name": 393}, {"name": 394}, {"name": 395}, {"name": 396}, {"name": 397}, {"name": 398}, {"name": 399}], "links": [{"source": 0, "target": 257}, {"source": 0, "target": 2}, {"source": 0, "target": 3}, {"source": 0, "target": 5}, {"source": 0, "target": 8}, {"source": 0, "target": 143}, {"source": 0, "target": 152}, {"source": 0, "target": 26}, {"source": 0, "target": 163}, {"source": 0, "target": 47}, {"source": 0, "target": 177}, {"source": 0, "target": 54}, {"source": 0, "target": 195}, {"source": 0, "target": 197}, {"source": 0, "target": 77}, {"source": 0, "target": 79}, {"source": 0, "target": 223}, {"source": 0, "target": 100}, {"source": 0, "target": 357}, {"source": 0, "target": 360}, {"source": 0, "target": 108}, {"source": 0, "target": 111}, {"source": 0, "target": 114}, {"source": 0, "target": 372}, {"source": 1, "target": 2}, {"source": 1, "target": 7}, {"source": 1, "target": 231}, {"source": 1, "target": 367}, {"source": 1, "target": 176}, {"source": 1, "target": 177}, {"source": 1, "target": 277}, {"source": 1, "target": 57}, {"source": 1, "target": 26}, {"source": 2, "target": 3}, {"source": 2, "target": 4}, {"source": 2, "target": 5}, {"source": 2, "target": 6}, {"source": 2, "target": 7}, {"source": 2, "target": 8}, {"source": 2, "target": 9}, {"source": 2, "target": 10}, {"source": 2, "target": 11}, {"source": 2, "target": 12}, {"source": 2, "target": 14}, {"source": 2, "target": 15}, {"source": 2, "target": 16}, {"source": 2, "target": 18}, {"source": 2, "target": 19}, {"source": 2, "target": 23}, {"source": 2, "target": 24}, {"source": 2, "target": 282}, {"source": 2, "target": 27}, {"source": 2, "target": 158}, {"source": 2, "target": 261}, {"source": 2, "target": 160}, {"source": 2, "target": 34}, {"source": 2, "target": 35}, {"source": 2, "target": 37}, {"source": 2, "target": 38}, {"source": 2, "target": 308}, {"source": 2, "target": 40}, {"source": 2, "target": 42}, {"source": 2, "target": 302}, {"source": 2, "target": 304}, {"source": 2, "target": 392}, {"source": 2, "target": 243}, {"source": 2, "target": 52}, {"source": 2, "target": 286}, {"source": 2, "target": 137}, {"source": 2, "target": 56}, {"source": 2, "target": 180}, {"source": 2, "target": 58}, {"source": 2, "target": 187}, {"source": 2, "target": 188}, {"source": 2, "target": 329}, {"source": 2, "target": 72}, {"source": 2, "target": 140}, {"source": 2, "target": 74}, {"source": 2, "target": 76}, {"source": 2, "target": 208}, {"source": 2, "target": 210}, {"source": 2, "target": 213}, {"source": 2, "target": 343}, {"source": 2, "target": 88}, {"source": 2, "target": 223}, {"source": 2, "target": 226}, {"source": 2, "target": 227}, {"source": 2, "target": 100}, {"source": 2, "target": 358}, {"source": 2, "target": 106}, {"source": 2, "target": 108}, {"source": 2, "target": 370}, {"source": 2, "target": 115}, {"source": 2, "target": 116}, {"source": 2, "target": 246}, {"source": 2, "target": 119}, {"source": 2, "target": 121}, {"source": 2, "target": 122}, {"source": 2, "target": 380}, {"source": 3, "target": 4}, {"source": 3, "target": 134}, {"source": 3, "target": 11}, {"source": 3, "target": 271}, {"source": 3, "target": 20}, {"source": 3, "target": 25}, {"source": 3, "target": 196}, {"source": 3, "target": 157}, {"source": 3, "target": 32}, {"source": 3, "target": 163}, {"source": 3, "target": 39}, {"source": 3, "target": 68}, {"source": 3, "target": 70}, {"source": 3, "target": 328}, {"source": 3, "target": 209}, {"source": 3, "target": 83}, {"source": 3, "target": 238}, {"source": 3, "target": 115}, {"source": 3, "target": 372}, {"source": 3, "target": 377}, {"source": 3, "target": 251}, {"source": 4, "target": 103}, {"source": 4, "target": 264}, {"source": 4, "target": 73}, {"source": 4, "target": 74}, {"source": 4, "target": 75}, {"source": 4, "target": 12}, {"source": 4, "target": 45}, {"source": 4, "target": 386}, {"source": 4, "target": 144}, {"source": 4, "target": 209}, {"source": 4, "target": 146}, {"source": 4, "target": 179}, {"source": 4, "target": 20}, {"source": 4, "target": 169}, {"source": 4, "target": 84}, {"source": 4, "target": 347}, {"source": 4, "target": 27}, {"source": 4, "target": 62}, {"source": 4, "target": 31}, {"source": 5, "target": 384}, {"source": 5, "target": 260}, {"source": 5, "target": 6}, {"source": 5, "target": 391}, {"source": 5, "target": 44}, {"source": 5, "target": 125}, {"source": 5, "target": 312}, {"source": 5, "target": 217}, {"source": 5, "target": 28}, {"source": 5, "target": 29}, {"source": 6, "target": 96}, {"source": 6, "target": 113}, {"source": 6, "target": 145}, {"source": 6, "target": 232}, {"source": 6, "target": 10}, {"source": 6, "target": 44}, {"source": 6, "target": 82}, {"source": 6, "target": 334}, {"source": 6, "target": 93}, {"source": 6, "target": 17}, {"source": 6, "target": 18}, {"source": 6, "target": 339}, {"source": 6, "target": 21}, {"source": 6, "target": 138}, {"source": 6, "target": 56}, {"source": 6, "target": 91}, {"source": 6, "target": 60}, {"source": 6, "target": 61}, {"source": 7, "target": 35}, {"source": 7, "target": 322}, {"source": 7, "target": 66}, {"source": 7, "target": 205}, {"source": 7, "target": 48}, {"source": 7, "target": 49}, {"source": 7, "target": 275}, {"source": 7, "target": 213}, {"source": 7, "target": 150}, {"source": 7, "target": 280}, {"source": 7, "target": 283}, {"source": 7, "target": 378}, {"source": 7, "target": 155}, {"source": 7, "target": 29}, {"source": 8, "target": 65}, {"source": 8, "target": 34}, {"source": 8, "target": 66}, {"source": 8, "target": 37}, {"source": 8, "target": 71}, {"source": 8, "target": 40}, {"source": 8, "target": 9}, {"source": 8, "target": 298}, {"source": 8, "target": 208}, {"source": 8, "target": 13}, {"source": 8, "target": 110}, {"source": 8, "target": 15}, {"source": 8, "target": 16}, {"source": 8, "target": 51}, {"source": 8, "target": 162}, {"source": 8, "target": 186}, {"source": 8, "target": 220}, {"source": 8, "target": 69}, {"source": 9, "target": 38}, {"source": 9, "target": 14}, {"source": 9, "target": 21}, {"source": 9, "target": 54}, {"source": 9, "target": 24}, {"source": 9, "target": 221}, {"source": 10, "target": 129}, {"source": 10, "target": 36}, {"source": 10, "target": 166}, {"source": 10, "target": 136}, {"source": 10, "target": 335}, {"source": 10, "target": 25}, {"source": 10, "target": 154}, {"source": 11, "target": 136}, {"source": 11, "target": 107}, {"source": 11, "target": 13}, {"source": 11, "target": 365}, {"source": 11, "target": 119}, {"source": 11, "target": 92}, {"source": 12, "target": 171}, {"source": 12, "target": 36}, {"source": 12, "target": 104}, {"source": 12, "target": 201}, {"source": 12, "target": 43}, {"source": 12, "target": 22}, {"source": 14, "target": 326}, {"source": 14, "target": 43}, {"source": 14, "target": 205}, {"source": 14, "target": 49}, {"source": 14, "target": 50}, {"source": 14, "target": 86}, {"source": 14, "target": 41}, {"source": 14, "target": 159}, {"source": 14, "target": 253}, {"source": 14, "target": 63}, {"source": 15, "target": 33}, {"source": 15, "target": 86}, {"source": 15, "target": 307}, {"source": 15, "target": 362}, {"source": 15, "target": 77}, {"source": 15, "target": 51}, {"source": 15, "target": 52}, {"source": 15, "target": 53}, {"source": 15, "target": 22}, {"source": 15, "target": 23}, {"source": 15, "target": 89}, {"source": 15, "target": 185}, {"source": 15, "target": 123}, {"source": 15, "target": 313}, {"source": 15, "target": 30}, {"source": 16, "target": 388}, {"source": 16, "target": 173}, {"source": 16, "target": 142}, {"source": 16, "target": 48}, {"source": 16, "target": 17}, {"source": 16, "target": 19}, {"source": 16, "target": 92}, {"source": 16, "target": 319}, {"source": 17, "target": 340}, {"source": 17, "target": 98}, {"source": 17, "target": 132}, {"source": 18, "target": 112}, {"source": 18, "target": 72}, {"source": 18, "target": 80}, {"source": 18, "target": 146}, {"source": 18, "target": 122}, {"source": 18, "target": 59}, {"source": 18, "target": 189}, {"source": 19, "target": 33}, {"source": 19, "target": 132}, {"source": 19, "target": 168}, {"source": 19, "target": 238}, {"source": 19, "target": 399}, {"source": 19, "target": 306}, {"source": 19, "target": 59}, {"source": 19, "target": 60}, {"source": 19, "target": 125}, {"source": 19, "target": 383}, {"source": 20, "target": 69}, {"source": 20, "target": 181}, {"source": 20, "target": 55}, {"source": 20, "target": 121}, {"source": 20, "target": 315}, {"source": 20, "target": 284}, {"source": 21, "target": 129}, {"source": 21, "target": 227}, {"source": 21, "target": 47}, {"source": 21, "target": 145}, {"source": 21, "target": 211}, {"source": 22, "target": 130}, {"source": 22, "target": 75}, {"source": 22, "target": 214}, {"source": 22, "target": 157}, {"source": 23, "target": 31}, {"source": 23, "target": 235}, {"source": 23, "target": 109}, {"source": 24, "target": 99}, {"source": 24, "target": 138}, {"source": 24, "target": 338}, {"source": 24, "target": 67}, {"source": 24, "target": 53}, {"source": 24, "target": 30}, {"source": 25, "target": 288}, {"source": 25, "target": 200}, {"source": 25, "target": 270}, {"source": 25, "target": 210}, {"source": 25, "target": 277}, {"source": 25, "target": 87}, {"source": 25, "target": 88}, {"source": 25, "target": 91}, {"source": 26, "target": 290}, {"source": 26, "target": 228}, {"source": 26, "target": 101}, {"source": 26, "target": 327}, {"source": 26, "target": 64}, {"source": 26, "target": 41}, {"source": 26, "target": 76}, {"source": 26, "target": 141}, {"source": 26, "target": 156}, {"source": 26, "target": 351}, {"source": 26, "target": 28}, {"source": 26, "target": 261}, {"source": 27, "target": 32}, {"source": 27, "target": 179}, {"source": 28, "target": 327}, {"source": 28, "target": 349}, {"source": 28, "target": 272}, {"source": 28, "target": 249}, {"source": 28, "target": 57}, {"source": 28, "target": 61}, {"source": 29, "target": 202}, {"source": 30, "target": 68}, {"source": 30, "target": 84}, {"source": 30, "target": 153}, {"source": 30, "target": 148}, {"source": 31, "target": 266}, {"source": 31, "target": 85}, {"source": 31, "target": 214}, {"source": 31, "target": 248}, {"source": 31, "target": 94}, {"source": 32, "target": 128}, {"source": 32, "target": 39}, {"source": 32, "target": 233}, {"source": 32, "target": 139}, {"source": 32, "target": 109}, {"source": 32, "target": 90}, {"source": 32, "target": 63}, {"source": 33, "target": 71}, {"source": 33, "target": 55}, {"source": 33, "target": 251}, {"source": 33, "target": 286}, {"source": 34, "target": 102}, {"source": 34, "target": 393}, {"source": 34, "target": 98}, {"source": 34, "target": 46}, {"source": 34, "target": 336}, {"source": 34, "target": 85}, {"source": 35, "target": 110}, {"source": 35, "target": 79}, {"source": 35, "target": 149}, {"source": 35, "target": 58}, {"source": 36, "target": 289}, {"source": 36, "target": 325}, {"source": 36, "target": 198}, {"source": 36, "target": 141}, {"source": 36, "target": 78}, {"source": 36, "target": 280}, {"source": 36, "target": 181}, {"source": 36, "target": 120}, {"source": 36, "target": 219}, {"source": 37, "target": 165}, {"source": 37, "target": 258}, {"source": 37, "target": 272}, {"source": 37, "target": 342}, {"source": 37, "target": 287}, {"source": 37, "target": 229}, {"source": 38, "target": 225}, {"source": 38, "target": 356}, {"source": 38, "target": 294}, {"source": 38, "target": 42}, {"source": 38, "target": 330}, {"source": 38, "target": 140}, {"source": 38, "target": 45}, {"source": 38, "target": 174}, {"source": 38, "target": 212}, {"source": 38, "target": 105}, {"source": 38, "target": 124}, {"source": 38, "target": 317}, {"source": 38, "target": 318}, {"source": 38, "target": 95}, {"source": 39, "target": 349}, {"source": 39, "target": 134}, {"source": 39, "target": 311}, {"source": 40, "target": 65}, {"source": 40, "target": 293}, {"source": 40, "target": 95}, {"source": 41, "target": 224}, {"source": 41, "target": 320}, {"source": 41, "target": 131}, {"source": 41, "target": 292}, {"source": 41, "target": 396}, {"source": 41, "target": 120}, {"source": 42, "target": 324}, {"source": 42, "target": 133}, {"source": 42, "target": 168}, {"source": 42, "target": 311}, {"source": 42, "target": 243}, {"source": 42, "target": 215}, {"source": 43, "target": 114}, {"source": 44, "target": 161}, {"source": 44, "target": 172}, {"source": 44, "target": 113}, {"source": 44, "target": 50}, {"source": 44, "target": 118}, {"source": 44, "target": 153}, {"source": 44, "target": 219}, {"source": 44, "target": 62}, {"source": 44, "target": 166}, {"source": 45, "target": 296}, {"source": 45, "target": 313}, {"source": 45, "target": 46}, {"source": 46, "target": 231}, {"source": 46, "target": 392}, {"source": 46, "target": 269}, {"source": 46, "target": 182}, {"source": 48, "target": 97}, {"source": 48, "target": 354}, {"source": 48, "target": 355}, {"source": 48, "target": 264}, {"source": 48, "target": 299}, {"source": 48, "target": 306}, {"source": 48, "target": 373}, {"source": 48, "target": 154}, {"source": 48, "target": 285}, {"source": 49, "target": 393}, {"source": 50, "target": 368}, {"source": 51, "target": 347}, {"source": 51, "target": 364}, {"source": 51, "target": 126}, {"source": 52, "target": 123}, {"source": 53, "target": 397}, {"source": 54, "target": 331}, {"source": 55, "target": 197}, {"source": 55, "target": 394}, {"source": 55, "target": 235}, {"source": 55, "target": 81}, {"source": 55, "target": 319}, {"source": 56, "target": 241}, {"source": 56, "target": 155}, {"source": 56, "target": 315}, {"source": 57, "target": 67}, {"source": 57, "target": 246}, {"source": 57, "target": 353}, {"source": 57, "target": 284}, {"source": 57, "target": 139}, {"source": 57, "target": 398}, {"source": 57, "target": 81}, {"source": 57, "target": 150}, {"source": 57, "target": 317}, {"source": 58, "target": 102}, {"source": 58, "target": 262}, {"source": 58, "target": 105}, {"source": 58, "target": 314}, {"source": 59, "target": 192}, {"source": 60, "target": 101}, {"source": 60, "target": 247}, {"source": 60, "target": 268}, {"source": 60, "target": 87}, {"source": 60, "target": 218}, {"source": 60, "target": 222}, {"source": 61, "target": 358}, {"source": 63, "target": 64}, {"source": 63, "target": 160}, {"source": 63, "target": 82}, {"source": 63, "target": 151}, {"source": 64, "target": 70}, {"source": 66, "target": 258}, {"source": 66, "target": 171}, {"source": 66, "target": 107}, {"source": 66, "target": 200}, {"source": 66, "target": 245}, {"source": 66, "target": 309}, {"source": 67, "target": 385}, {"source": 67, "target": 73}, {"source": 67, "target": 301}, {"source": 67, "target": 78}, {"source": 67, "target": 211}, {"source": 67, "target": 116}, {"source": 67, "target": 377}, {"source": 68, "target": 256}, {"source": 68, "target": 267}, {"source": 68, "target": 382}, {"source": 69, "target": 348}, {"source": 69, "target": 221}, {"source": 72, "target": 224}, {"source": 72, "target": 249}, {"source": 72, "target": 106}, {"source": 73, "target": 161}, {"source": 73, "target": 222}, {"source": 73, "target": 111}, {"source": 75, "target": 230}, {"source": 75, "target": 376}, {"source": 75, "target": 83}, {"source": 75, "target": 151}, {"source": 75, "target": 184}, {"source": 77, "target": 240}, {"source": 77, "target": 228}, {"source": 77, "target": 80}, {"source": 77, "target": 244}, {"source": 78, "target": 124}, {"source": 79, "target": 194}, {"source": 79, "target": 164}, {"source": 79, "target": 170}, {"source": 79, "target": 365}, {"source": 79, "target": 302}, {"source": 79, "target": 118}, {"source": 80, "target": 291}, {"source": 80, "target": 371}, {"source": 80, "target": 90}, {"source": 80, "target": 158}, {"source": 80, "target": 127}, {"source": 81, "target": 96}, {"source": 81, "target": 388}, {"source": 81, "target": 97}, {"source": 82, "target": 354}, {"source": 82, "target": 259}, {"source": 82, "target": 165}, {"source": 82, "target": 104}, {"source": 82, "target": 267}, {"source": 82, "target": 94}, {"source": 82, "target": 216}, {"source": 82, "target": 89}, {"source": 82, "target": 189}, {"source": 82, "target": 126}, {"source": 83, "target": 196}, {"source": 83, "target": 397}, {"source": 83, "target": 190}, {"source": 85, "target": 242}, {"source": 85, "target": 93}, {"source": 86, "target": 142}, {"source": 88, "target": 193}, {"source": 88, "target": 103}, {"source": 88, "target": 137}, {"source": 88, "target": 234}, {"source": 88, "target": 117}, {"source": 88, "target": 248}, {"source": 88, "target": 252}, {"source": 89, "target": 131}, {"source": 89, "target": 133}, {"source": 89, "target": 112}, {"source": 89, "target": 218}, {"source": 91, "target": 178}, {"source": 91, "target": 233}, {"source": 92, "target": 357}, {"source": 92, "target": 295}, {"source": 92, "target": 301}, {"source": 92, "target": 175}, {"source": 92, "target": 333}, {"source": 92, "target": 186}, {"source": 92, "target": 381}, {"source": 92, "target": 350}, {"source": 94, "target": 294}, {"source": 94, "target": 300}, {"source": 94, "target": 366}, {"source": 94, "target": 147}, {"source": 94, "target": 149}, {"source": 94, "target": 184}, {"source": 95, "target": 99}, {"source": 95, "target": 199}, {"source": 95, "target": 332}, {"source": 95, "target": 206}, {"source": 95, "target": 178}, {"source": 95, "target": 117}, {"source": 95, "target": 278}, {"source": 95, "target": 127}, {"source": 96, "target": 318}, {"source": 97, "target": 340}, {"source": 97, "target": 374}, {"source": 97, "target": 279}, {"source": 99, "target": 217}, {"source": 99, "target": 389}, {"source": 100, "target": 323}, {"source": 101, "target": 353}, {"source": 101, "target": 290}, {"source": 101, "target": 167}, {"source": 101, "target": 172}, {"source": 102, "target": 192}, {"source": 102, "target": 257}, {"source": 102, "target": 299}, {"source": 102, "target": 207}, {"source": 103, "target": 297}, {"source": 104, "target": 176}, {"source": 104, "target": 199}, {"source": 105, "target": 307}, {"source": 105, "target": 287}, {"source": 106, "target": 305}, {"source": 106, "target": 260}, {"source": 106, "target": 343}, {"source": 108, "target": 295}, {"source": 109, "target": 321}, {"source": 109, "target": 230}, {"source": 109, "target": 265}, {"source": 109, "target": 368}, {"source": 109, "target": 152}, {"source": 110, "target": 360}, {"source": 110, "target": 391}, {"source": 113, "target": 202}, {"source": 113, "target": 379}, {"source": 114, "target": 130}, {"source": 114, "target": 229}, {"source": 114, "target": 143}, {"source": 115, "target": 156}, {"source": 116, "target": 276}, {"source": 116, "target": 198}, {"source": 117, "target": 128}, {"source": 117, "target": 352}, {"source": 120, "target": 380}, {"source": 121, "target": 147}, {"source": 121, "target": 334}, {"source": 122, "target": 281}, {"source": 123, "target": 203}, {"source": 124, "target": 265}, {"source": 124, "target": 191}, {"source": 124, "target": 135}, {"source": 126, "target": 278}, {"source": 128, "target": 352}, {"source": 128, "target": 169}, {"source": 128, "target": 234}, {"source": 128, "target": 237}, {"source": 128, "target": 366}, {"source": 128, "target": 148}, {"source": 131, "target": 144}, {"source": 131, "target": 263}, {"source": 131, "target": 325}, {"source": 133, "target": 164}, {"source": 134, "target": 135}, {"source": 134, "target": 236}, {"source": 134, "target": 175}, {"source": 134, "target": 274}, {"source": 134, "target": 259}, {"source": 134, "target": 342}, {"source": 134, "target": 254}, {"source": 135, "target": 195}, {"source": 135, "target": 232}, {"source": 135, "target": 371}, {"source": 135, "target": 276}, {"source": 135, "target": 344}, {"source": 136, "target": 336}, {"source": 137, "target": 283}, {"source": 137, "target": 188}, {"source": 137, "target": 314}, {"source": 138, "target": 185}, {"source": 140, "target": 390}, {"source": 140, "target": 303}, {"source": 140, "target": 345}, {"source": 140, "target": 316}, {"source": 140, "target": 191}, {"source": 143, "target": 204}, {"source": 144, "target": 338}, {"source": 146, "target": 183}, {"source": 147, "target": 256}, {"source": 147, "target": 159}, {"source": 147, "target": 316}, {"source": 147, "target": 255}, {"source": 148, "target": 193}, {"source": 148, "target": 220}, {"source": 148, "target": 167}, {"source": 149, "target": 269}, {"source": 150, "target": 395}, {"source": 152, "target": 241}, {"source": 152, "target": 383}, {"source": 153, "target": 182}, {"source": 157, "target": 170}, {"source": 159, "target": 291}, {"source": 159, "target": 271}, {"source": 161, "target": 162}, {"source": 161, "target": 226}, {"source": 161, "target": 183}, {"source": 162, "target": 363}, {"source": 162, "target": 173}, {"source": 162, "target": 212}, {"source": 162, "target": 245}, {"source": 165, "target": 297}, {"source": 166, "target": 329}, {"source": 166, "target": 369}, {"source": 168, "target": 225}, {"source": 168, "target": 346}, {"source": 168, "target": 174}, {"source": 169, "target": 273}, {"source": 169, "target": 254}, {"source": 171, "target": 180}, {"source": 174, "target": 324}, {"source": 175, "target": 215}, {"source": 176, "target": 207}, {"source": 177, "target": 292}, {"source": 178, "target": 250}, {"source": 178, "target": 204}, {"source": 179, "target": 194}, {"source": 179, "target": 187}, {"source": 179, "target": 326}, {"source": 179, "target": 300}, {"source": 182, "target": 203}, {"source": 184, "target": 273}, {"source": 186, "target": 240}, {"source": 186, "target": 346}, {"source": 186, "target": 263}, {"source": 188, "target": 190}, {"source": 189, "target": 289}, {"source": 189, "target": 201}, {"source": 189, "target": 206}, {"source": 189, "target": 367}, {"source": 189, "target": 376}, {"source": 189, "target": 247}, {"source": 189, "target": 312}, {"source": 190, "target": 363}, {"source": 191, "target": 236}, {"source": 193, "target": 281}, {"source": 193, "target": 375}, {"source": 193, "target": 361}, {"source": 194, "target": 356}, {"source": 194, "target": 370}, {"source": 194, "target": 332}, {"source": 196, "target": 364}, {"source": 197, "target": 216}, {"source": 197, "target": 270}, {"source": 199, "target": 330}, {"source": 200, "target": 279}, {"source": 202, "target": 275}, {"source": 202, "target": 399}, {"source": 205, "target": 369}, {"source": 206, "target": 288}, {"source": 207, "target": 344}, {"source": 209, "target": 242}, {"source": 210, "target": 385}, {"source": 211, "target": 398}, {"source": 221, "target": 387}, {"source": 221, "target": 310}, {"source": 223, "target": 237}, {"source": 223, "target": 262}, {"source": 224, "target": 274}, {"source": 224, "target": 293}, {"source": 224, "target": 239}, {"source": 225, "target": 321}, {"source": 225, "target": 390}, {"source": 225, "target": 362}, {"source": 225, "target": 250}, {"source": 228, "target": 359}, {"source": 229, "target": 373}, {"source": 231, "target": 384}, {"source": 231, "target": 322}, {"source": 231, "target": 255}, {"source": 235, "target": 323}, {"source": 235, "target": 253}, {"source": 236, "target": 298}, {"source": 236, "target": 239}, {"source": 236, "target": 244}, {"source": 242, "target": 389}, {"source": 243, "target": 333}, {"source": 243, "target": 285}, {"source": 246, "target": 252}, {"source": 246, "target": 386}, {"source": 246, "target": 337}, {"source": 248, "target": 296}, {"source": 248, "target": 305}, {"source": 250, "target": 268}, {"source": 251, "target": 303}, {"source": 255, "target": 374}, {"source": 258, "target": 350}, {"source": 260, "target": 282}, {"source": 261, "target": 351}, {"source": 264, "target": 266}, {"source": 264, "target": 310}, {"source": 270, "target": 308}, {"source": 275, "target": 348}, {"source": 277, "target": 304}, {"source": 279, "target": 320}, {"source": 280, "target": 395}, {"source": 285, "target": 359}, {"source": 286, "target": 331}, {"source": 286, "target": 375}, {"source": 297, "target": 339}, {"source": 301, "target": 309}, {"source": 305, "target": 341}, {"source": 307, "target": 382}, {"source": 311, "target": 328}, {"source": 313, "target": 335}, {"source": 313, "target": 341}, {"source": 317, "target": 396}, {"source": 318, "target": 381}, {"source": 330, "target": 337}, {"source": 333, "target": 345}, {"source": 336, "target": 378}, {"source": 338, "target": 361}, {"source": 342, "target": 379}, {"source": 344, "target": 355}, {"source": 357, "target": 387}, {"source": 380, "target": 394}], "multigraph": false}
G=G_5;


//  G= $.getJSON("HISBmodel/G.json", function(data) {


//      return data;

// });
// g=JSON.parse(G);
// console.log(g);

var valid_data = 1;
var running = 0;
var running1 = 0;
var NodeSelected = 0;
var time_interval = 10;
var count = 0;
var timeseries;
var End = 0;
var Statistical_anal=0;

var NodeDeg=[];
var nodeArray = G.nodes;
var edgeArray = G.links;
var ListInfectedNodes = [];
var Stat;

var time = 0.125;

var sir_color = { S: "#0000ff", I: "#ff0000", R: "#08b808", RuP: "#0f00f0" }
var Opinion_color = { N: "#0000ff", Su: "#039b8b", D: "#bbb01b" }

var epi_state = { S: nodeArray.length, I: 0, R: 0, OpP: 0, OpD: 0, RuP: 0 };

Stat={
  DD: { label: "Degree Distribution", color: "#0000ff", data: [] },
  ADD: { label: "Accepted Rumors", color: "#0000ff", data: [] },
  SDD: { label: "Sent Rumors", color: "#ff00ff", data: [] },

};
function reset_history() {
  timeseries = {
    S: { label: "S", color: sir_color.S, data: [] },
    I: { label: "Spreaders", color: sir_color.I, data: [] },
    R: { label: "Infected nodes", color: sir_color.R, data: [] },
    RuP: { label: "Rumor Popularity", color: sir_color.RuP, data: [] },
    OpP: { label: "Supporting Opinion", color: Opinion_color.Su, data: [] },
    OpD: { label: "Denying Opinion", color: Opinion_color.D, data: [] },
  };

  timeseries.S.data.push([count, epi_state.S]);
  timeseries.I.data.push([count, epi_state.I]);
  timeseries.R.data.push([count, epi_state.R]);
  timeseries.RuP.data.push([count, epi_state.RuP]);
  timeseries.OpP.data.push([count, epi_state.OpD]);
  timeseries.OpD.data.push([count, epi_state.OpD]);
}

reset_history();

var plotOptions = {
  lines: { show: true },
  
  xaxis: { min: 0 },
  series: { shadowSize: 0 }

};
var plotOptions2 = {
  lines: { show: false },
  points: { show: true },
  xaxis: { min: 0 },
  series: { shadowSize: 0 }

};

var plot = $.plot($("#epicurves"), [], plotOptions);
var plot2 = $.plot($("#Infcurves2"), [], plotOptions);
var plotRP = $.plot($("#RumorPopuCurves"), [], plotOptions);
var plotOp = $.plot($("#OpinionCurves"), [], plotOptions);
var plotDD = $.plot($("#Nodes_degree_distribution"), [], plotOptions2);
var plotARDD = $.plot($("#Acc_RumorDD"), [], plotOptions2);
var plotSRDD = $.plot($("#Sent_RumorDD"), [], plotOptions2);




function getRandomIntInclusive(min, max) {
  min = Math.ceil(min);
  max = Math.floor(max);
  return (Math.floor(Math.random() * (max - min + 1)) + min) / 100; //The maximum is inclusive and the minimum is inclusive 
}

var kArray = [];
var Node_opinion = [];

for (i in nodeArray) {
  kArray[nodeArray[i].name] = 0;
  nodeArray[i].Adj = [];
  
}

for (i in edgeArray) {
  s = edgeArray[i].source;
  t = edgeArray[i].target;
  kArray[s]++;
  kArray[t]++;
  nodeArray[s].Adj[nodeArray[s].Adj.length] = t;
  nodeArray[t].Adj[nodeArray[t].Adj.length] = s;

}


  
  var MaxDeg=0;


for (i in nodeArray) {
  nodeArray[i].k = kArray[i];
  if (MaxDeg<nodeArray[i].k) {
    MaxDeg=nodeArray[i].k;
    
  }
  nodeArray[i].state = "S";
  nodeArray[i].opinion = "N";
  min = Number($("#Beta_min").val());
  max = Number($("#Beta_max").val());
  nodeArray[i].beta = getRandomIntInclusive(min * 100, max * 100);
  min = Number($("#Omega_min").val());
  max = Number($("#Omega_max").val());
  nodeArray[i].omega = getRandomIntInclusive(min * 100, max * 100);
  min = Number($("#Delta_min").val());
  max = Number($("#Delta_max").val());
  nodeArray[i].delta = getRandomIntInclusive(min * 100, max * 100);
  min = Number($("#J_min").val());
  max = Number($("#J_max").val());
  nodeArray[i].j = getRandomIntInclusive(min * 100, max * 100);
  nodeArray[i].F_j = nodeArray[i].j;
  nodeArray[i].Infetime = 0;
  nodeArray[i].NbrAccpR = 0;
  nodeArray[i].NbrAccptDR = 0;
  nodeArray[i].NbrSendR = 0;
  nodeArray[i].ColorNode = "#00f";


}

for (let index = 1; index <= MaxDeg; index++) {
  NodeDeg[index]=0;
  
 
}

for (i in nodeArray) {
  NodeDeg[nodeArray[i].k]++;
  
}

for (let index = 1; index <= MaxDeg; index++) {
  if (NodeDeg[index] !=0 ) {
    Stat.DD.data.push([index, NodeDeg[index]]); 
  }
  
}

plotDD.setData([Stat.DD]);
plotDD.setupGrid();
plotDD.draw();



var div = d3.select("body").append("div")
  .attr("class", "tooltip")
  .style("opacity", 0);

var w = "100%";
var h = 650;
var vis2 = d3.select("#graph-layout_opinion")
  .append("svg:svg")
  .attr("width", w)
  .attr("height", h)
  .call(d3.behavior.zoom().on("zoom", function () {
    vis2.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")")
  }))
  .append("g");

var vis = d3.select("#graph-layout")
  .append("svg:svg")
  .attr("width", w)
  .attr("height", h)
  .call(d3.behavior.zoom().on("zoom", function () {
    vis.attr("transform", "translate(" + d3.event.translate + ")" + " scale(" + d3.event.scale + ")")
  }))
  .append("g");

var force2 = d3.layout.force()
  .charge(-50)
  .linkStrength(0.5)
  .friction(0.6)
  .gravity(0.02)
  .linkDistance(100)
  .nodes(nodeArray)
  .links(edgeArray)
  .size([300, h]);

var force = d3.layout.force()
  .charge(-200)
  .linkStrength(0.5)
  .friction(0.5)
  .gravity(0.02)
  .linkDistance(100)
  .nodes(nodeArray)
  .links(edgeArray)
  .size([300, h]);







force.on("tick", function () {
  vis.selectAll("line.link")
    .attr("x1", function (d) { return d.source.x; })
    .attr("y1", function (d) { return d.source.y; })
    .attr("x2", function (d) { return d.target.x; })
    .attr("y2", function (d) { return d.target.y; });

  vis.selectAll("circle.node")
    .attr("cx", function (d) { return d.x; })
    .attr("cy", function (d) { return d.y; })
    .style("fill", function (d) { return d.ColorNode; });
});

force2.on("tick", function () {
  vis2.selectAll("line.link")
    .attr("x1", function (d) { return d.source.x; })
    .attr("y1", function (d) { return d.source.y; })
    .attr("x2", function (d) { return d.target.x; })
    .attr("y2", function (d) { return d.target.y; });

  vis2.selectAll("circle.node")
    .attr("cx", function (d) { return d.x; })
    .attr("cy", function (d) { return d.y; })
    .style("fill", function (d) { return Opinion_color[d.opinion]; });
});





$("#Time_sime").val(time_interval)
$("#Time_sime").keyup(update_Sim_time);


update_graph();
update_plot();
update_counters();

$("#reset-button").click(reset_all);
$("#Start-button").click(Start_propagation);
$("#Pause-button").click(Pause_sim);
function Pause_sim() {
  $('#Pause-button').prop('disabled', true);
  if (running == 1) {
    running = 0;
  }
  $('#Start-button').prop('disabled', false);
}



function update_graph() {

  x = vis.selectAll("line.link").data(edgeArray, function (d) { return d.source.name + "-" + d.target.name; });
  x.enter().insert("svg:line", "circle.node")
    .attr("class", "link")
    .attr("x1", function (d) { return d.source.x; })
    .attr("y1", function (d) { return d.source.y; })
    .attr("x2", function (d) { return d.target.x; })
    .attr("y2", function (d) { return d.target.y; });
  x.exit().remove();



  x = vis.selectAll("circle.node").data(nodeArray, function (d) { return d.name; });
  x.enter().insert("svg:circle")
    .attr("class", "node")
    .attr("cx", function (d) { return d.x; })
    .attr("cy", function (d) { return d.y; })
    .attr("r", function (d) { return 4 * Math.sqrt(d.k); })
    .style("fill", function (d) { return d.ColorNode; })
    .call(force.drag)
    .on("click", function (d, i) {
     
      if (running == 0 && valid_data == 1 && d.state == "S") {
        d.opinion = "Su";
        epi_state.OpP++;
        d.state = "I";
        epi_state.S--;
        epi_state.RuP += d.k;
        epi_state.I++;
        NodeSelected = 1;
        d.Infetime = time;
        d.NbrAccpR++;
        ListInfectedNodes[ListInfectedNodes.length] = i;
        d.ColorNode = "#f00";
      }
      update_counters();
      update_plot();
    })
    .on("mouseover", function (d) {
      div.transition()
        .duration(200)
        .style("opacity", .9);
      div.html("Node Id: " + d.name + "<br/>" + "Node degree: " + d.k
        + "<br/>" + "Beta: " + d.beta
        + "<br/>" + "omega: " + d.omega
        + "<br/>" + "delta: " + d.delta
        + "<br/>" + "delta: " + d.j
        + "<br/>" + "Color: " + d.ColorNode)
        .style("left", (d3.event.pageX+50) + "px")
        .style("top", (d3.event.pageY-50) + "px");
    })
    .on("mouseout", function (d) {
      div.transition()
        .duration(500)
        .style("opacity", 0);
    });

  x.exit().remove();
  force.start();

  x = vis2.selectAll("line.link").data(edgeArray, function (d) { return d.source.name + "-" + d.target.name; });
  x.enter().insert("svg:line", "circle.node")
    .attr("class", "link")
    .attr("x1", function (d) { return d.source.x; })
    .attr("y1", function (d) { return d.source.y; })
    .attr("x2", function (d) { return d.target.x; })
    .attr("y2", function (d) { return d.target.y; });
  x.exit().remove();



  x = vis2.selectAll("circle.node").data(nodeArray, function (d) { return d.name; });
  x.enter().insert("svg:circle")
    .attr("class", "node")
    .attr("cx", function (d) { return d.x; })
    .attr("cy", function (d) { return d.y; })
    .attr("r", function (d) { return 4 * Math.sqrt(d.k); })
    .style("fill", function (d) { return d.ColorNode; })
    .call(force2.drag)
    .on("click", function (d, i) {
      if (running == 0 && valid_data == 1 && d.state == "S") {
        d.opinion = "Su";
        d.state = "I";
        epi_state.OpP++;
        epi_state.S--;
        epi_state.RuP += d.k;
        epi_state.I++;
        d.NbrAccpR++;
        NodeSelected = 1;
        d.Infetime = time;
        ListInfectedNodes[ListInfectedNodes.length] = i;
        d.opinion = "Su";
        d.state = "I";
        d.ColorNode = "#f00";
      }
      else {
        if (running == 0 && valid_data == 1 && d.opinion == "D") {
          d.opinion = "Su";
          epi_state.OpP++;
          epi_state.OpD--;
        }
        else {
          d.opinion = "D";
          epi_state.OpP--;
          epi_state.OpD++;
        }
      }
      update_counters();
      update_plot();
    })
    .on("mouseover", function (d) {
      div.transition()
        .duration(200)
        .style("opacity", .9);
      div.html("Node Id: " + d.name + "<br/>"
        + "Node degree: " + d.k + "<br/>"
        + "Nbr of Acc. rumor: " + d.NbrAccpR + "<br/>"
        + "Nbr of Sent rumor: " + d.NbrSendR + "<br/>"
        + "Nbr of Acc. -Opi " + d.NbrAccptDR)
        .style("left", (d3.event.pageX + 50) + "px")
        .style("top", (d3.event.pageY - 50 ) + "px");
    })
    .on("mouseout", function (d) {
      div.transition()
        .duration(500)
        .style("opacity", 0);
    });
  x.exit().remove();
  force2.start();

}

function update_plot() {
  plot.setData([timeseries.I]);
  plot.setupGrid();
  plot.draw();

  plot2.setData([timeseries.R]);
  plot2.setupGrid();
  plot2.draw();

  plotRP.setData([timeseries.OpD, timeseries.OpP]);
  plotRP.setupGrid();
  plotRP.draw();


  plotOp.setData([timeseries.RuP]);
  plotOp.setupGrid();
  plotOp.draw();

}


function update_counters() {
  $("#count_I").html(epi_state.I);
  $("#count_R").html(epi_state.R);
  $("#count_S").html(epi_state.S);
  $("#count_SO").html(epi_state.OpP);
  $("#count_DO").html(epi_state.OpD);

}



function update_Sim_time() {
  p = Number($("#Time_sime").val());
  if (isNaN(p) || p < 0.0 || p > 2000) {
    valid_data = 0;
    $("#Time_sime").css("background-color", "#f88");
  } else {
    time_interval = p;
    valid_data = 1;

    $("#Time_sime").css("background-color", "#fff");
  }
  setInterval(run_SIR, time_interval);
}
function Start_propagation() {
  setInterval(run_HISBmodel, time_interval);
  if (End == 1) {
    rest_all();
    if (NodeSelected == 1) {
      $("#start-text").fadeOut();
      $("#start-text2").fadeOut();

      running = 1;
    }
    else {
      var i = 1;
      while (i <= 10) {
        ID = Math.floor(Math.random() * nodeArray.length)
        if (nodeArray[ID].Infetime == 0) {
          nodeArray[ID].Infetime = 0.125;
          nodeArray[ID].NbrAccpR++;
          ListInfectedNodes[ListInfectedNodes.length] = ID;

          if (Math.random() > 0.5) {
            nodeArray[ID].opinion = "Su";
            epi_state.OpP++;
          }
          else {
            nodeArray[ID].opinion = "D";
            nodeArray[ID].NbrAccptDR++;
            epi_state.OpD++;
          }
          nodeArray[ID].state = "I"; epi_state.S--; epi_state.I++; epi_state.RuP += nodeArray[ID].k; NodeSelected = 1;
          update_graph();
          update_counters();
          i++;
        }
      }
      NodeSelected == 1;
      $("#start-text").fadeOut();
      $("#start-text2").fadeOut();
      running = 1;
    }
  }
  else {
    if (NodeSelected == 1) {
      $("#start-text").fadeOut();
      $("#start-text2").fadeOut();

      running = 1;
    }
    else {
      var i = 1;
      while (i <= 10) {
        ID = Math.floor(Math.random() * nodeArray.length)
        if (nodeArray[ID].Infetime == 0) {
          nodeArray[ID].state = "I";
          nodeArray[ID].Infetime = 0.125;
          ListInfectedNodes[ListInfectedNodes.length] = ID;
          nodeArray[ID].NbrAccpR++;
          if (Math.random() > 0.5) {

            nodeArray[ID].opinion = "Su";
            epi_state.OpP++;
          }
          else {
            nodeArray[ID].opinion = "D";
            epi_state.OpD++;
            nodeArray[ID].NbrAccptDR++;
          }
          epi_state.S--; epi_state.I++;
          epi_state.RuP += nodeArray[ID].k;
          NodeSelected = 1;
          update_graph();
          update_counters();
          update_plot();

          i++;
        }
      }

      update_plot();
      update_counters();
      NodeSelected == 1;
      $("#start-text").fadeOut();
      $("#start-text2").fadeOut();
      running = 1;
    }
  }
  $('#Pause-button').prop('disabled', false);
  $('#Start-button').prop('disabled', true);

}

function UpdateOpinion(i) {

  var DecFactor = (nodeArray[i].F_j + (nodeArray[i].NbrAccptDR / nodeArray[i].NbrAccpR)) * 0.5;

 
  if (nodeArray[i].opinion == "Su") epi_state.OpP--; else epi_state.OpD--;
  if (Math.random() <= DecFactor) {
    nodeArray[i].opinion = "D";
    epi_state.OpD++;


  }
  else {
    nodeArray[i].opinion = "Su";
    epi_state.OpP++;

  }

}

function reset_all() {

  running = 0;
  NodeSelected = 0;
  count = 0;
  End = 0;
  epi_state = { S: nodeArray.length, I: 0, R: 0, OpP: 0, OpD: 0, RuP: 0 };
  ListInfectedNodes = [];
  time = 0.125;

  reset_history();
  update_plot();

  update_counters();

  for (i in nodeArray) {
    nodeArray[i].state = "S";
    nodeArray[i].opinion = "N";
    min = Number($("#Beta_min").val());
    max = Number($("#Beta_max").val());
    nodeArray[i].beta = getRandomIntInclusive(min * 100, max * 100);
    min = Number($("#Omega_min").val());
    max = Number($("#Omega_max").val());
    nodeArray[i].omega = getRandomIntInclusive(min * 100, max * 100);
    min = Number($("#Delta_min").val());
    max = Number($("#Delta_max").val());
    nodeArray[i].delta = getRandomIntInclusive(min * 100, max * 100);
    min = Number($("#J_min").val());
    max = Number($("#J_max").val());
    nodeArray[i].j = getRandomIntInclusive(min * 100, max * 100);
    nodeArray[i].Infetime = 0;
    nodeArray[i].NbrAccpR = 0;
    nodeArray[i].NbrAccptDR = 0;
    nodeArray[i].NbrSendR = 0;
    nodeArray[i].ColorNode = "#00f";

  }
  update_graph();

  $("#start-text").fadeIn();
  $("#start-text2").fadeIn();
  $('#Start-button').prop('disabled', false);
  $('#Pause-button').prop('disabled', false);
}



function run_HISBmodel() {

  if (running == 0) {
    return;
  }



  epi_state.RuP = 0;
  epi_state.I = 0;
  var ID = 0;

  for (ID = ListInfectedNodes.length - 1; ID >= 0; ID--) {

    var i;
    i = ListInfectedNodes[ID];

    NodeRelativeTime = time - nodeArray[i].Infetime;

    if (Math.exp(-NodeRelativeTime * nodeArray[i].beta) < 0.1) {
      ListInfectedNodes.splice(ID, 1);
      nodeArray[i].state = "R";



    }
    else {

      var ActualAttraction;
      ActualAttraction = Math.exp(-NodeRelativeTime * nodeArray[i].beta) * Math.abs(Math.sin(NodeRelativeTime * nodeArray[i].omega + nodeArray[i].delta));
      UpdateColor(i, ActualAttraction);
      epi_state.RuP += ActualAttraction * nodeArray[i].k;
      var SendingProbability;
      SendingProbability = ActualAttraction;

      var p = 0.35;


      if (Math.random() <= SendingProbability) {

        epi_state.I += 1;



        for (let index = 0; index < nodeArray[i].Adj.length - 1; index++) {
          j = nodeArray[i].Adj[index];

          if (Math.random() <= p) {
            nodeArray[i].NbrSendR++;
            AcceptanceProbability = nodeArray[i].k / (nodeArray[i].k + nodeArray[j].k) * 0.5;

            if (Math.random() <= AcceptanceProbability) {
              
              nodeArray[j].NbrAccpR++;

              if (nodeArray[j].Infetime == 0) {
                epi_state.R++;
                epi_state.S--;
                nodeArray[j].Infetime = time;
                ListInfectedNodes[ListInfectedNodes.length] = j;
                nodeArray[j].opinion = nodeArray[i].opinion;
                nodeArray[j].state = "I";
                if (nodeArray[j].opinion == "Su") {
                  epi_state.OpP++;

                } else {
                  epi_state.OpD++;
                  nodeArray[j].NbrAccptDR++;

                }
                UpdateOpinion(i);


              }
              else {
                if (nodeArray[j].opinion == "D") nodeArray[j].NbrAccptDR++;
                UpdateOpinion(i);

              }


            }

          }


        }

      }

    }


  }

  update_graph();

  count++;
  time += 0.125;

  timeseries.S.data.push([time, epi_state.S]);
  timeseries.I.data.push([time, epi_state.I]);
  timeseries.R.data.push([time, epi_state.R]);
  timeseries.RuP.data.push([time, epi_state.RuP]);
  timeseries.OpP.data.push([time, epi_state.OpP]);
  timeseries.OpD.data.push([time, epi_state.OpD]);
  epi_state.I = 0;
  update_plot();

  update_counters();

  if (ListInfectedNodes.length == 0) { Update_stat(); running = 0; End = 1; };


}






function UpdateColor(i, Atrraction) {
  nodeArray[i].ColorNode = RGB2Color((256 * Atrraction), (256 * (1 - Atrraction)), 0);
}

function RGB2Color(r, g, b) {
  return 'rgb(' + Math.round(r) + ',' + Math.round(g) + ',' + Math.round(b) + ')';
}
Update_stat();

function Update_stat() {
  $("#Stat_NN").html(nodeArray.length);
  var NbrEdge = 0;
  var NbrRumorSent = 0;
  var NbrRumorA = 0;
  var b = 0;
  var o = 0;
  var h = 0;
  var jB = 0;
  var jA = 0;
  var NPOS = 0;
  var NDOS = 0;


  for (let index = 0; index < nodeArray.length; index++) {
    NbrEdge += nodeArray[index].k;
    NbrRumorSent += nodeArray[index].NbrSendR;
    NbrRumorA += nodeArray[index].NbrAccpR;
    b += nodeArray[index].beta;
    o += nodeArray[index].omega;
    h += nodeArray[index].delta;
    jB += nodeArray[index].j;
    jA += nodeArray[index].F_j;
    NDOS += nodeArray[index].NbrAccptDR;

  }
  NPOS += NbrRumorA - NDOS;
  $("#Stat_NE").html(NbrEdge);
  $("#Stat_k").html(Math.floor(NbrEdge / nodeArray.length * 1000) / 1000);
  $("#Stat_ASR").html(Math.floor(NbrRumorSent / nodeArray.length * 1000) / 1000);
  $("#Stat_AAR").html(Math.floor(NbrRumorA / nodeArray.length * 1000) / 1000);
  $("#Stat_AIBK").html(Math.floor(b / nodeArray.length * 1000) / 1000);
  $("#Stat_AFR").html(Math.floor(o / nodeArray.length * 1000) / 1000);
  $("#Stat_AHM").html(Math.floor(h / nodeArray.length * 1000) / 1000);
  $("#JB").html(Math.floor(jB / nodeArray.length * 1000) / 1000);
  $("#JA").html(Math.floor(jA / nodeArray.length * 1000) / 1000);
  $("#Stat_NRR").html(epi_state.R);
  $("#Stat_NnRR").html(epi_state.S);
  $("#Stat_RLT").html(time - 0.125);
  $("#Stat_SR").html(NbrRumorSent);
  $("#Stat_AR").html(NbrRumorA);
  $("#Stat_PO").html(NPOS);
  $("#Stat_DO").html(NDOS);
  update_Statistics() ;


}

function update_Statistics() {
  Stat.ADD.data=[];
  Stat.SDD.data=[];

  plotSRDD.setData([Stat.SDD]);
  plotSRDD.setupGrid();
  plotSRDD.draw();

  plotARDD.setData([Stat.ADD]);
  plotARDD.setupGrid();
  plotARDD.draw();    

  var AccRuorDeg=[];
  var SentRuorDeg=[];
  for (let index = 0; index < nodeArray.length; index++) {
    if (AccRuorDeg[nodeArray[index].k]== null)  AccRuorDeg[nodeArray[index].k]=nodeArray[index].NbrAccpR;else AccRuorDeg[nodeArray[index].k]+=nodeArray[index].NbrAccpR;
    if (SentRuorDeg[nodeArray[index].k]== null)  SentRuorDeg[nodeArray[index].k]=nodeArray[index].NbrSendR;else SentRuorDeg[nodeArray[index].k]+=nodeArray[index].NbrSendR;
    
  }


  for (let index = 1; index <= MaxDeg; index++) {
    if (NodeDeg[index] !=0 ) {
     
      Stat.ADD.data.push([index, AccRuorDeg[index]/NodeDeg[index]]);
      Stat.SDD.data.push([index, SentRuorDeg[index]/NodeDeg[index]]);
      
      
    }
    
    
  }
 
 

  
  plotSRDD.setData([Stat.SDD]);
  plotSRDD.setupGrid();
  plotSRDD.draw();

  plotARDD.setData([Stat.ADD]);
  plotARDD.setupGrid();
  plotARDD.draw();



}